import React, { useState, useEffect, useContext } from 'react';
import { useSpring, animated as a } from "react-spring";
import styled from "styled-components";
import { ThemeContext, useThemeContext, theme as currentTheme } from '../store/themeContext';

const Button = styled(a.div)`
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    pointer-events: auto;
    transition: all 0.3s ease-in-out;
`;
  
const ThemeSwitchButton = (props) => {

    const {theme, setTheme, isActive, setIsActive} = useThemeContext()

    const { x } = useSpring({ config: { duration: 300 }, x: isActive ? 1 : 0 });
    const [sunrayProps, setSunraySpring] = useSpring(() => ({
      opacity: 1
    }));
    const [starProps, setStarProps] = useSpring(() => ({
      opacity: 0
    }));

    useEffect(() => {
        if (!isActive) {
          setSunraySpring.start(() => ({ opacity: 1 }));
          setStarProps.start(() => ({ opacity: 0 }));
          setTheme(currentTheme.light)
        }
        if (isActive) {
            setSunraySpring.start(() => ({ opacity: 0 }));
            setStarProps.start(() => ({ opacity: 1 }));
            setTheme(currentTheme.dark)
        }
    }, [isActive, setSunraySpring, setStarProps]);
    
    const moonPath =
    "M166.72,289.61c7.65-99.34,130.78-131.67,137.52-123.68c5.65,6.7-64.39,49.08-58.74,105.58c4.24,42.37,50.27,84.84,92,84c50.72-1.02,85.57-65.82,97.12-57.86c6.44,4.44-0.9,26.95-7.42,41.28c-3.94,8.66-45,95.14-127.87,94.46C226.92,432.78,160.84,365.93,166.72,289.61z";
    const sunPath =
    "M166.72,289.61c5.15-69.56,65.77-125.7,137.52-123.68c21.91,0.62,43.17,8.87,43.17,8.87c23.88,9.06,39.16,22.44,44.52,27.44c5.95,5.55,42.9,41.1,42.68,95.41c-0.03,6.78-0.67,22.86-7.42,41.28c-15.81,43.14-63.58,94.99-127.87,94.46C228,432.79,160.92,367.9,166.72,289.61z";

    return (
        <Button
        onClick={() => {
            setIsActive(!isActive);
        }}
        style={{ background: theme.backgroundColor }}
        >
            <a.svg
                width="100%"
                height="100%"
                viewBox="0 0 600 600"
                xmlns="http://www.w3.org/2000/svg"
            >
                <rect
                x="2.5"
                y="2.5"
                width="595"
                height="595"
                fill={theme.contentColor}
                stroke={theme.backgroundColor}
                strokeWidth="5"
                />
                <a.path
                id="shapePath"
                d={x.to({
                    range: [0, 1],
                    output: [sunPath, moonPath]
                })}
                fill={theme.backgroundColor}
                />
                <g>
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M72.4089 404.006L128.741 370.96C131.017 369.625 132.069 369.013 133.052 368.757C135.568 368.103 138.23 368.816 140.082 370.641C140.806 371.354 141.411 372.409 142.715 374.704C144.019 376.998 144.615 378.058 144.861 379.052C145.491 381.594 144.768 384.293 142.952 386.179C142.242 386.917 141.195 387.537 138.919 388.872L82.5869 421.918C80.3107 423.253 79.2592 423.864 78.2754 424.12C75.7596 424.775 73.0974 424.062 71.2458 422.237C70.5218 421.523 69.9168 420.468 68.6131 418.174C67.3093 415.879 66.7125 414.819 66.4664 413.826C65.8368 411.284 66.56 408.585 68.3759 406.698C69.086 405.961 70.1327 405.341 72.4089 404.006Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M162.247 506.865L194.94 449.328C196.204 447.104 196.79 446.081 197.486 445.384C199.354 443.512 202.067 442.785 204.621 443.472C205.572 443.729 206.591 444.321 208.797 445.616C211.004 446.91 212.018 447.51 212.712 448.219C214.575 450.123 215.313 452.874 214.651 455.453C214.404 456.414 213.825 457.442 212.562 459.666L179.868 517.202C178.605 519.426 178.018 520.449 177.323 521.146C175.455 523.018 172.741 523.745 170.188 523.058C169.236 522.802 168.217 522.209 166.011 520.915C163.805 519.62 162.79 519.02 162.096 518.311C160.233 516.408 159.496 513.656 160.158 511.077C160.404 510.116 160.983 509.088 162.247 506.865Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M51.1596 278.813H116.034C118.713 278.813 119.948 278.818 120.944 279.104C123.431 279.816 125.374 281.76 126.087 284.247C126.373 285.243 126.377 286.477 126.377 289.157C126.377 291.836 126.373 293.071 126.087 294.067C125.374 296.553 123.431 298.497 120.944 299.21C119.948 299.495 118.713 299.5 116.034 299.5H51.1596C48.4803 299.5 47.2455 299.495 46.2497 299.21C43.7631 298.497 41.8193 296.553 41.1065 294.067C40.8211 293.071 40.8162 291.836 40.8162 289.157C40.8162 286.477 40.8211 285.243 41.1065 284.247C41.8193 281.76 43.7631 279.816 46.2497 279.104C47.2455 278.818 48.4803 278.813 51.1596 278.813Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M82.5868 176.984L138.919 210.03C141.195 211.365 142.242 211.985 142.952 212.722C144.768 214.609 145.491 217.308 144.861 219.85C144.615 220.843 144.019 221.903 142.715 224.198C141.411 226.492 140.806 227.547 140.082 228.261C138.23 230.086 135.568 230.799 133.052 230.144C132.069 229.888 131.017 229.277 128.741 227.942L72.409 194.896C70.1328 193.561 69.086 192.941 68.3759 192.203C66.56 190.317 65.8368 187.618 66.4664 185.076C66.7125 184.082 67.3093 183.022 68.6131 180.728C69.9168 178.433 70.5218 177.378 71.2458 176.665C73.0974 174.84 75.7596 174.127 78.2754 174.781C79.2592 175.037 80.3107 175.649 82.5868 176.984Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M308.986 481.756V548.364C308.986 550.881 308.982 552.042 308.73 552.981C308.035 555.566 306.016 557.586 303.431 558.28C302.492 558.532 301.331 558.536 298.814 558.536C296.297 558.536 295.137 558.532 294.197 558.28C291.612 557.586 289.593 555.566 288.899 552.981C288.647 552.042 288.642 550.881 288.642 548.364V481.756C288.642 479.239 288.647 478.079 288.899 477.14C289.593 474.554 291.612 472.535 294.197 471.841C295.137 471.589 296.297 471.584 298.814 471.584C301.331 471.584 302.492 471.589 303.431 471.841C306.016 472.535 308.035 474.554 308.73 477.14C308.982 478.079 308.986 479.239 308.986 481.756Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M417.865 517.202L385.172 459.666C383.908 457.442 383.329 456.414 383.083 455.454C382.421 452.874 383.158 450.123 385.021 448.219C385.715 447.51 386.73 446.91 388.936 445.616C391.142 444.321 392.161 443.729 393.113 443.473C395.666 442.785 398.38 443.512 400.248 445.384C400.943 446.082 401.53 447.104 402.793 449.328L435.487 506.865C436.75 509.089 437.329 510.116 437.576 511.077C438.238 513.657 437.5 516.408 435.637 518.311C434.943 519.02 433.929 519.62 431.722 520.915C429.516 522.209 428.497 522.802 427.546 523.058C424.992 523.745 422.279 523.018 420.411 521.146C419.715 520.449 419.129 519.426 417.865 517.202Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M525.48 194.896L469.148 227.942C466.872 229.277 465.821 229.888 464.837 230.144C462.321 230.799 459.659 230.086 457.807 228.261C457.083 227.547 456.478 226.492 455.174 224.198C453.871 221.903 453.274 220.843 453.028 219.85C452.398 217.308 453.121 214.609 454.937 212.722C455.647 211.985 456.694 211.365 458.97 210.03L515.302 176.984C517.578 175.649 518.63 175.037 519.614 174.781C522.13 174.127 524.792 174.84 526.643 176.665C527.367 177.378 527.972 178.433 529.276 180.728C530.58 183.022 531.177 184.082 531.423 185.076C532.052 187.618 531.329 190.317 529.513 192.203C528.803 192.941 527.756 193.561 525.48 194.896Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M310.172 51.6358V118.244C310.172 120.761 310.168 121.921 309.915 122.861C309.221 125.446 307.202 127.465 304.617 128.159C303.677 128.411 302.517 128.416 300 128.416C297.483 128.416 296.323 128.411 295.383 128.159C292.798 127.465 290.779 125.446 290.085 122.861C289.832 121.921 289.828 120.761 289.828 118.244V51.6358C289.828 49.1187 289.832 47.9584 290.085 47.019C290.779 44.4338 292.798 42.4146 295.383 41.7204C296.323 41.4682 297.483 41.4639 300 41.4639C302.517 41.4639 303.677 41.4682 304.617 41.7204C307.202 42.4146 309.221 44.4338 309.915 47.019C310.168 47.9584 310.172 49.1187 310.172 51.6358Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M168.011 90.2919L200.704 147.828C201.968 150.052 202.546 151.079 202.793 152.04C203.455 154.62 202.718 157.371 200.855 159.275C200.161 159.984 199.146 160.584 196.94 161.878C194.734 163.173 193.714 163.765 192.763 164.021C190.209 164.709 187.496 163.982 185.628 162.11C184.932 161.412 184.346 160.389 183.082 158.166L150.389 100.629C149.125 98.4054 148.547 97.378 148.3 96.4171C147.638 93.8373 148.375 91.0862 150.238 89.1829C150.932 88.4739 151.947 87.8734 154.153 86.5792C156.36 85.2849 157.379 84.6923 158.33 84.4361C160.884 83.7484 163.597 84.4754 165.465 86.3477C166.161 87.0452 166.747 88.068 168.011 90.2919Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M515.302 421.918L458.97 388.872C456.694 387.537 455.647 386.917 454.937 386.179C453.121 384.293 452.398 381.594 453.028 379.052C453.274 378.058 453.871 376.998 455.174 374.704C456.478 372.409 457.083 371.354 457.807 370.641C459.659 368.816 462.321 368.103 464.837 368.757C465.821 369.013 466.872 369.625 469.148 370.96L525.48 404.006C527.756 405.341 528.803 405.961 529.513 406.698C531.329 408.585 532.052 411.284 531.423 413.826C531.177 414.819 530.58 415.879 529.276 418.174C527.972 420.468 527.367 421.523 526.643 422.237C524.792 424.062 522.13 424.775 519.614 424.12C518.63 423.864 517.578 423.253 515.302 421.918Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M548.84 310.343H483.966C481.287 310.343 480.052 310.339 479.056 310.053C476.569 309.34 474.626 307.397 473.913 304.91C473.627 303.914 473.623 302.679 473.623 300C473.623 297.321 473.627 296.086 473.913 295.09C474.626 292.604 476.569 290.66 479.056 289.947C480.052 289.662 481.287 289.657 483.966 289.657H548.84C551.52 289.657 552.754 289.662 553.75 289.947C556.237 290.66 558.181 292.604 558.893 295.09C559.179 296.086 559.184 297.321 559.184 300C559.184 302.679 559.179 303.914 558.893 304.91C558.181 307.397 556.237 309.34 553.75 310.053C552.754 310.339 551.52 310.343 548.84 310.343Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="sunray"
                    style={{ opacity: sunrayProps.opacity }}
                    d="M448.53 100.629L415.837 158.166C414.573 160.39 413.987 161.412 413.291 162.11C411.423 163.982 408.71 164.709 406.156 164.021C405.205 163.765 404.186 163.173 401.979 161.878C399.773 160.584 398.758 159.984 398.064 159.275C396.201 157.371 395.464 154.62 396.126 152.04C396.373 151.08 396.951 150.052 398.215 147.828L430.908 90.292C432.172 88.0681 432.758 87.0453 433.454 86.3478C435.322 84.4755 438.035 83.7485 440.589 84.4362C441.54 84.6924 442.56 85.2851 444.766 86.5793C446.972 87.8736 447.987 88.474 448.681 89.183C450.544 91.0863 451.281 93.8374 450.619 96.4172C450.373 97.3781 449.794 98.4055 448.53 100.629Z"
                    fill="#2C2C2C"
                    stroke="#C4C4C4"
                />
                <a.path
                    className="star"
                    style={{ opacity: starProps.opacity }}
                    d="M210.189 473.94L225.677 494.848C226.048 495.349 226.57 495.716 227.165 495.893L252.538 503.442C253.809 503.82 254.312 505.397 253.479 506.465L237.718 526.666C237.309 527.191 237.091 527.842 237.099 528.509L237.426 553.841C237.443 555.155 236.194 556.077 234.989 555.686L209.569 547.462C209.001 547.278 208.39 547.278 207.822 547.462L182.403 555.686C181.197 556.077 179.949 555.155 179.966 553.841L180.292 528.509C180.301 527.842 180.083 527.191 179.673 526.666L163.912 506.465C163.079 505.397 163.583 503.82 164.853 503.442L190.226 495.893C190.822 495.716 191.343 495.349 191.714 494.848L207.203 473.94C207.951 472.929 209.44 472.929 210.189 473.94Z"
                    fill="#C4C4C4"
                    stroke="#2C2C2C"
                />
                <a.path
                    className="star"
                    style={{ opacity: starProps.opacity }}
                    d="M104.063 39.0045L123.59 65.3994C123.961 65.9007 124.482 66.2683 125.077 66.4456L157.129 75.9949C158.399 76.3731 158.902 77.9484 158.07 79.0164L138.125 104.615C137.717 105.139 137.499 105.789 137.508 106.456L137.921 138.516C137.937 139.83 136.689 140.752 135.483 140.361L103.444 129.981C102.875 129.796 102.263 129.796 101.695 129.981L69.6554 140.361C68.4497 140.752 67.2008 139.83 67.2177 138.516L67.6303 106.456C67.6389 105.789 67.4213 105.139 67.0128 104.615L47.0685 79.0164C46.2364 77.9484 46.7396 76.3731 48.009 75.9949L80.0609 66.4456C80.6562 66.2683 81.1776 65.9007 81.5485 65.3994L101.075 39.0045C101.824 37.9923 103.314 37.9923 104.063 39.0045Z"
                    fill="#C4C4C4"
                    stroke="#2C2C2C"
                />
                <a.path
                    className="star"
                    style={{ opacity: starProps.opacity }}
                    d="M478.31 71.4577L490.905 94.2684C491.331 95.0405 492.083 95.5763 492.948 95.7195L519.299 100.076C520.811 100.326 521.416 102.237 520.298 103.336L501.839 121.486C501.172 122.142 500.86 123.084 501 124.012L504.791 149.202C505.02 150.723 503.498 151.856 502.159 151.226L477.888 139.823C477.122 139.463 476.238 139.463 475.472 139.823L451.201 151.226C449.862 151.856 448.34 150.723 448.568 149.202L452.359 124.012C452.499 123.084 452.188 122.142 451.52 121.486L433.061 103.336C431.943 102.237 432.549 100.326 434.061 100.076L460.411 95.7195C461.277 95.5763 462.028 95.0405 462.455 94.2684L475.049 71.4577C475.765 70.1612 477.595 70.1612 478.31 71.4577Z"
                    fill="#C4C4C4"
                    stroke="#2C2C2C"
                />
                </g>
            </a.svg>
        </Button>
    )
}

export default ThemeSwitchButton